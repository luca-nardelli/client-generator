import '../utils/maker.dart';
import '../utils/api-platform.dart';
{{#each imports}}
import '{{file}}';
{{/each}}

class {{name}} extends BaseModel {
{{#each fields}}
  {{~#if reference}}
    {{~#if maxCardinality}}
  {{{type}}} _{{{name}}}
    {{~else}}
  List<{{{type}}}> _{{{name}}}
    {{~/if}}
  {{~else}}
  {{{type}}} _{{{name}}}
  {{~/if}};
{{/each}}

{{#each fields}}
  var _{{name}}Dirty = false;
{{/each}}

  {{name}}({iri{{#each fields}}, {{name}}{{/each~}} }) : super(iri: iri) {
  {{#each fields}}
    this.{{name}} = {{name}};
  {{/each}}
  }

  {{name}}.fromJson(Map<String, dynamic> json): super.fromJson(json) {
{{#each fields}}
    if (json.containsKey('{{name}}')){
{{~#if reference}}
  {{~#if maxCardinality}}
      {{~name}} = {{type}}.fromJsonOrIri(json['{{name}}']);
  {{~else}}
      {{~name}} = (json['{{name}}'] as List ?? []).map((elem) => {{type}}.fromJsonOrIri(elem)).toList();
  {{~/if}}
{{~else~}}
      {{~name}} = json['{{name}}'];
{{~/if~}}
    }
{{/each}}
  }

  {{name}}.fromIri(String iri) : super.fromIri(iri);

  factory {{name}}.fromJsonOrIri(dynamic jsonOrIri) {
    if (jsonOrIri is String) {
      return {{name}}.fromIri(jsonOrIri);
    } else if (jsonOrIri is Map) {
      return {{name}}.fromJson(jsonOrIri);
    }
    return null;
  }

  toJson([Map<Type,Map<Type,SerializationOptions>> options = null]) {
    final data = super.toJson();
{{#each fields}}
  {{~#if reference}}
    {{~#if maxCardinality}}
    nullSerializer<{{../name}},{{type}}>(data,'{{name}}',{{name}},{{name}}Dirty, options);
    {{~else}}
    nullSerializer<{{../name}},{{type}}>(data,'{{name}}',{{name}},{{name}}Dirty, options);
    {{~/if}}
  {{~else}}
    nullSerializer<{{../name}},{{type}}>(data,'{{name}}',{{name}},{{name}}Dirty);
  {{~/if}}

{{/each}}
    return data;
  }

  // Getters and setters
{{#each fields}}
  {{~#if reference}}
    {{~#if maxCardinality}}
  {{{type}}} get {{{name}}} { return _{{name}}; }
  bool get {{{name}}}Dirty { return _{{name}}Dirty; }
  set {{{name}}}({{{type}}} val) { _{{name}} = val; _{{name}}Dirty = true; }
    {{~else}}
  List<{{{type}}}> get {{{name}}} { return _{{name}}; }
  bool get {{{name}}}Dirty { return _{{name}}Dirty; }
  set {{{name}}}(List<{{{type}}}> val) { _{{name}} = val; _{{name}}Dirty = true; }
    {{~/if}}
  {{~else}}
  {{{type}}} get {{{name}}} { return _{{name}}; }
  bool get {{{name}}}Dirty { return _{{name}}Dirty; }
  set {{{name}}}({{{type}}} val) { _{{name}} = val; _{{name}}Dirty = true; }
  {{~/if}}

{{/each}}

}

class {{name}}SerializationOptions {
{{#each fields}}
  {{~#if reference}}

  {{type}}SerializationOptions {{{name}}};
  {{~/if}}
{{/each}}





}
